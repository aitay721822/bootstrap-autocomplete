{"version":3,"sources":["../../src/js/util.js","../../src/js/autocomplete.js"],"sourcesContent":["/**\r\n * --------------------------------------------------------------------------\r\n * Bootstrap (v4.3.1): util.js\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\r\n * --------------------------------------------------------------------------\r\n */\r\n\r\nimport $ from 'jquery'\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * Private TransitionEnd Helpers\r\n * ------------------------------------------------------------------------\r\n */\r\n\r\nconst TRANSITION_END = 'transitionend'\r\nconst MAX_UID = 1000000\r\nconst MILLISECONDS_MULTIPLIER = 1000\r\n\r\n// Shoutout AngusCroll (https://goo.gl/pxwQGp)\r\nfunction toType(obj) {\r\n  return {}.toString.call(obj).match(/\\s([a-z]+)/i)[1].toLowerCase()\r\n}\r\n\r\nfunction getSpecialTransitionEndEvent() {\r\n  return {\r\n    bindType: TRANSITION_END,\r\n    delegateType: TRANSITION_END,\r\n    handle(event) {\r\n      if ($(event.target).is(this)) {\r\n        return event.handleObj.handler.apply(this, arguments) // eslint-disable-line prefer-rest-params\r\n      }\r\n      return undefined // eslint-disable-line no-undefined\r\n    }\r\n  }\r\n}\r\n\r\nfunction transitionEndEmulator(duration) {\r\n  let called = false\r\n\r\n  $(this).one(Util.TRANSITION_END, () => {\r\n    called = true\r\n  })\r\n\r\n  setTimeout(() => {\r\n    if (!called) {\r\n      Util.triggerTransitionEnd(this)\r\n    }\r\n  }, duration)\r\n\r\n  return this\r\n}\r\n\r\nfunction setTransitionEndSupport() {\r\n  $.fn.emulateTransitionEnd = transitionEndEmulator\r\n  $.event.special[Util.TRANSITION_END] = getSpecialTransitionEndEvent()\r\n}\r\n\r\n/**\r\n * --------------------------------------------------------------------------\r\n * Public Util Api\r\n * --------------------------------------------------------------------------\r\n */\r\n\r\nconst Util = {\r\n\r\n  TRANSITION_END: 'bsTransitionEnd',\r\n\r\n  getUID(prefix) {\r\n    do {\r\n      // eslint-disable-next-line no-bitwise\r\n      prefix += ~~(Math.random() * MAX_UID) // \"~~\" acts like a faster Math.floor() here\r\n    } while (document.getElementById(prefix))\r\n    return prefix\r\n  },\r\n\r\n  getSelectorFromElement(element) {\r\n    let selector = element.getAttribute('data-target')\r\n\r\n    if (!selector || selector === '#') {\r\n      const hrefAttr = element.getAttribute('href')\r\n      selector = hrefAttr && hrefAttr !== '#' ? hrefAttr.trim() : ''\r\n    }\r\n\r\n    try {\r\n      return document.querySelector(selector) ? selector : null\r\n    } catch (err) {\r\n      return null\r\n    }\r\n  },\r\n\r\n  getTransitionDurationFromElement(element) {\r\n    if (!element) {\r\n      return 0\r\n    }\r\n\r\n    // Get transition-duration of the element\r\n    let transitionDuration = $(element).css('transition-duration')\r\n    let transitionDelay = $(element).css('transition-delay')\r\n\r\n    const floatTransitionDuration = parseFloat(transitionDuration)\r\n    const floatTransitionDelay = parseFloat(transitionDelay)\r\n\r\n    // Return 0 if element or transition duration is not found\r\n    if (!floatTransitionDuration && !floatTransitionDelay) {\r\n      return 0\r\n    }\r\n\r\n    // If multiple durations are defined, take the first\r\n    transitionDuration = transitionDuration.split(',')[0]\r\n    transitionDelay = transitionDelay.split(',')[0]\r\n\r\n    return (parseFloat(transitionDuration) + parseFloat(transitionDelay)) * MILLISECONDS_MULTIPLIER\r\n  },\r\n\r\n  reflow(element) {\r\n    return element.offsetHeight\r\n  },\r\n\r\n  triggerTransitionEnd(element) {\r\n    $(element).trigger(TRANSITION_END)\r\n  },\r\n\r\n  // TODO: Remove in v5\r\n  supportsTransitionEnd() {\r\n    return Boolean(TRANSITION_END)\r\n  },\r\n\r\n  isElement(obj) {\r\n    return (obj[0] || obj).nodeType\r\n  },\r\n\r\n  typeCheckConfig(componentName, config, configTypes) {\r\n    for (const property in configTypes) {\r\n      if (Object.prototype.hasOwnProperty.call(configTypes, property)) {\r\n        const expectedTypes = configTypes[property]\r\n        const value         = config[property]\r\n        const valueType     = value && Util.isElement(value)\r\n          ? 'element' : toType(value)\r\n\r\n        if (!new RegExp(expectedTypes).test(valueType)) {\r\n          throw new Error(\r\n            `${componentName.toUpperCase()}: ` +\r\n            `Option \"${property}\" provided type \"${valueType}\" ` +\r\n            `but expected type \"${expectedTypes}\".`)\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  findShadowRoot(element) {\r\n    if (!document.documentElement.attachShadow) {\r\n      return null\r\n    }\r\n\r\n    // Can find the shadow root otherwise it'll return the document\r\n    if (typeof element.getRootNode === 'function') {\r\n      const root = element.getRootNode()\r\n      return root instanceof ShadowRoot ? root : null\r\n    }\r\n\r\n    if (element instanceof ShadowRoot) {\r\n      return element\r\n    }\r\n\r\n    // when we don't find a shadow root\r\n    if (!element.parentNode) {\r\n      return null\r\n    }\r\n\r\n    return Util.findShadowRoot(element.parentNode)\r\n  }\r\n}\r\n\r\nsetTransitionEndSupport()\r\n\r\nexport default Util\r\n","/**\r\n * --------------------------------------------------------------------------\r\n * Bootstrap Autocomplete (v0.2.0): autocomplete.js\r\n * Licensed under MIT (https://github.com/iqbalfn/bootstrap-autocomplete/blob/master/LICENSE)\r\n * --------------------------------------------------------------------------\r\n */\r\n\r\nimport $ from \"jquery\";\r\nimport Util from \"./util\";\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * Constants\r\n * ------------------------------------------------------------------------\r\n */\r\n\r\nconst NAME = \"autocomplete\";\r\nconst VERSION = \"0.2.0\";\r\nconst DATA_KEY = \"bs.autocomplete\";\r\nconst EVENT_KEY = `.${DATA_KEY}`;\r\nconst DATA_API_KEY = \".data-api\";\r\nconst JQUERY_NO_CONFLICT = $.fn[NAME];\r\n\r\nconst Default = {\r\n  list: null,\r\n\r\n  prefetch: null,\r\n\r\n  filter: null,\r\n  filterDelay: 300,\r\n  filterMinChars: 1,\r\n  filterRelation: null,\r\n\r\n  maxResult: 10,\r\n\r\n  onPick: null,\r\n  onItemRendered: null,\r\n\r\n  preProcess: null,\r\n};\r\n\r\nconst DefaultType = {\r\n  list: \"(null|string|element)\",\r\n\r\n  prefetch: \"(null|string)\",\r\n\r\n  filter: \"(null|string)\",\r\n  filterDelay: \"number\",\r\n  filterMinChars: \"number\",\r\n  filterRelation: \"(null|object)\",\r\n\r\n  maxResult: \"number\",\r\n\r\n  preProcess: \"(null|function)\",\r\n\r\n  onPick: \"(null|function)\",\r\n  onItemRendered: \"(null|function)\",\r\n};\r\n\r\nconst Event = {\r\n  BLUR_DATA_API: `blur${EVENT_KEY}${DATA_API_KEY}`,\r\n  CLICK_DATA_API: `click${EVENT_KEY}${DATA_API_KEY}`,\r\n  KEYDOWN_DATA_API: `keydown${EVENT_KEY}${DATA_API_KEY}`,\r\n  INPUT_DATA_API: `input${EVENT_KEY}${DATA_API_KEY}`,\r\n\r\n  PICK: `pick${EVENT_KEY}`,\r\n  ITEM_RENDER: `itemrender${EVENT_KEY}`,\r\n};\r\n\r\nconst ClassName = {\r\n  DROPDOWN_MENU: \"dropdown-menu\",\r\n  DROPDOWN_ITEM: \"dropdown-item\",\r\n};\r\n\r\nconst KeyCode = {\r\n  ARROW_DOWN: 40,\r\n  ARROW_UP: 38,\r\n  ENTER: 13,\r\n  ESCAPE: 27,\r\n};\r\n\r\nconst Selector = {};\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * Class Definition\r\n * ------------------------------------------------------------------------\r\n */\r\n\r\nclass Autocomplete {\r\n  constructor(element, config) {\r\n    this._config = this._getConfig(config);\r\n    this._element = element;\r\n\r\n    this._items = [];\r\n    this._labels = {};\r\n\r\n    this._isShown = false;\r\n    this._dropdown = null;\r\n    this._spinner = null;\r\n    this._result = [];\r\n    this._query = \"\";\r\n    this._preventClose = false;\r\n    this._timer = null;\r\n    this._relations = null;\r\n\r\n    if (element.hasAttribute(\"list\")) {\r\n      this._config.list = `#${element.getAttribute(\"list\")}`;\r\n      element.removeAttribute(\"list\");\r\n    }\r\n\r\n    if (!this._config.list && !this._config.prefetch && !this._config.filter)\r\n      throw new TypeError(\"No data source provided\");\r\n\r\n    if (this._config.filterRelation) this._handleRelations();\r\n\r\n    element.setAttribute(\"autocomplete\", \"off\");\r\n\r\n    this._makeDropdown();\r\n    this._makeSpinner();\r\n    this._fetchPresetData();\r\n    this._addElementListener();\r\n  }\r\n\r\n  // Getters\r\n\r\n  static get VERSION() {\r\n    return VERSION;\r\n  }\r\n\r\n  static get Default() {\r\n    return Default;\r\n  }\r\n\r\n  // Public\r\n\r\n  show() {\r\n    if (this._isShown) return;\r\n\r\n    if (this._result.length) this._showDropdown();\r\n  }\r\n\r\n  hide() {\r\n    if (!this._isShown) return;\r\n\r\n    this._hideDropdown();\r\n  }\r\n\r\n  dispose() {\r\n    $(this._element).off(EVENT_KEY);\r\n\r\n    $.removeData(this._element, DATA_KEY);\r\n\r\n    this._config = null;\r\n    this._element = null;\r\n    this._items = null;\r\n    this._labels = null;\r\n    this._isShown = null;\r\n    this._dropdown = null;\r\n    this._spinner = null;\r\n    this._result = null;\r\n    this._query = null;\r\n    this._preventClose = null;\r\n    if (this._timer) clearTimeout(this._timer);\r\n    this._timer = null;\r\n  }\r\n\r\n  // Private\r\n\r\n  _addElementListener() {\r\n    $(this._element).on(\"focus\", (e) => {\r\n      this._query = this._element.value.trim().toLowerCase();\r\n      this._findFromList();\r\n    });\r\n\r\n    $(this._element).on(Event.KEYDOWN_DATA_API, (e) => {\r\n      let prevent = false;\r\n\r\n      switch (e.keyCode) {\r\n        case KeyCode.ARROW_DOWN:\r\n          if (e.altKey && !this._isShown) {\r\n            this._query = this._element.value.trim().toLowerCase();\r\n\r\n            if (this._query) {\r\n              this._findFromList();\r\n              prevent = true;\r\n            }\r\n          } else {\r\n            this._focusNext();\r\n            prevent = true;\r\n          }\r\n          break;\r\n\r\n        case KeyCode.ARROW_UP:\r\n          this._focusPrev();\r\n          prevent = true;\r\n          break;\r\n\r\n        case KeyCode.ENTER:\r\n          if (this._isShown) {\r\n            let item = $(this._dropdown).children(\".active\").get(0);\r\n            if (!item) item = $(this._dropdown).children(\":first-child\").get(0);\r\n\r\n            if (item) this._selectItem(item);\r\n\r\n            this.hide();\r\n            prevent = true;\r\n          }\r\n          break;\r\n\r\n        case KeyCode.ESCAPE:\r\n          prevent = true;\r\n          this.hide();\r\n          break;\r\n      }\r\n\r\n      if (prevent) e.preventDefault();\r\n    });\r\n\r\n    $(this._element).on(Event.INPUT_DATA_API, (e) => {\r\n      this._query = this._element.value.trim().toLowerCase();\r\n\r\n      if (!this._query) {\r\n        this._truncateDropdown();\r\n        this.hide();\r\n      } else {\r\n        this._findFromList();\r\n      }\r\n    });\r\n\r\n    $(this._element).on(Event.BLUR_DATA_API, (e) => {\r\n      if (this._preventClose) return;\r\n      setTimeout(() => this.hide(), 150);\r\n    });\r\n  }\r\n\r\n  _fetchPresetData() {\r\n    // from datalist\r\n    if (this._config.list) {\r\n      let dataList = this._config.list;\r\n      if (typeof dataList === \"string\")\r\n        dataList = document.querySelector(this._config.list);\r\n\r\n      if (dataList) {\r\n        Array.from(dataList.children).forEach((o) => {\r\n          let val = o.innerHTML.toLowerCase();\r\n          if (this._items.includes(val)) return;\r\n\r\n          this._items.push(val);\r\n          this._labels[val] = o.innerHTML;\r\n        });\r\n      }\r\n    }\r\n\r\n    // from prefetch\r\n    if (this._config.prefetch) {\r\n      this._showSpinner();\r\n      $.get(this._config.prefetch, (res) => {\r\n        this._hideSpinner();\r\n        if (this._config.preProcess) res = this._config.preProcess(res);\r\n\r\n        res.forEach((i) => {\r\n          let val = i.toLowerCase();\r\n          if (this._items.includes(val)) return;\r\n          this._items.push(val);\r\n          this._labels[val] = i;\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  _findFromAjax() {\r\n    if (!this._config.filter) return;\r\n    if (this._dropdown.children.length >= this._config.maxResult) return;\r\n\r\n    if (this._timer) clearTimeout(this._timer);\r\n\r\n    let vval = this._query;\r\n    this._timer = setTimeout(() => {\r\n      if (vval != this._query) return;\r\n      this._showSpinner();\r\n\r\n      let url = this._config.filter\r\n        .replace(/%23/g, \"#\")\r\n        .replace(\"#QUERY#\", this._query);\r\n\r\n      if (this._relations) {\r\n        let sep = url.includes(\"?\") ? \"&\" : \"?\";\r\n\r\n        for (let k in this._relations) {\r\n          let el = this._relations[k];\r\n          let val = $(el).val();\r\n          if (!val) continue;\r\n\r\n          url += `${sep}${k}=${val}`;\r\n          sep = \"&\";\r\n        }\r\n      }\r\n\r\n      $.get(url, (res) => {\r\n        this._hideSpinner();\r\n        if (this._config.preProcess) res = this._config.preProcess(res);\r\n\r\n        let local = [];\r\n        res.forEach((i) => {\r\n          let val = i.toLowerCase();\r\n          if (this._items.includes(val)) return;\r\n\r\n          this._items.push(val);\r\n          this._labels[val] = i;\r\n\r\n          local.push(i);\r\n          this._result.push(i);\r\n        });\r\n\r\n        if (local.length) this._renderItem(local);\r\n\r\n        if (this._result.length) this.show();\r\n        else this.hide();\r\n      });\r\n    }, this._config.filterDelay);\r\n  }\r\n\r\n  _findFromList() {\r\n    this._truncateDropdown();\r\n\r\n    // 先複製所有項目到 local\r\n    let local = [...Object.values(this._labels)];\r\n\r\n    // 如果有搜尋字串,則進行篩選\r\n    if (this._query) {\r\n      local = local.filter((label) =>\r\n        label.toLowerCase().includes(this._query)\r\n      );\r\n    }\r\n\r\n    // 更新結果集\r\n    this._result = local;\r\n\r\n    // 渲染結果\r\n    if (local.length) {\r\n      this._renderItem(local);\r\n      this.show();\r\n    } else {\r\n      this.hide();\r\n    }\r\n\r\n    this._findFromAjax();\r\n  }\r\n\r\n  _focusNext() {\r\n    let next = $(this._dropdown).children(\":first-child\").get(0);\r\n    let focused = $(this._dropdown).children(\".active\").get(0);\r\n\r\n    if (focused) {\r\n      focused.classList.remove(\"active\");\r\n      let tmpNext = $(focused).next().get(0);\r\n      if (tmpNext) next = tmpNext;\r\n    }\r\n\r\n    if (next) next.classList.add(\"active\");\r\n  }\r\n\r\n  _focusPrev() {\r\n    let next = $(this._dropdown).children(\":last-child\").get(0);\r\n    let focused = $(this._dropdown).children(\".active\").get(0);\r\n\r\n    if (focused) {\r\n      focused.classList.remove(\"active\");\r\n      let tmpNext = $(focused).prev().get(0);\r\n      if (tmpNext) next = tmpNext;\r\n    }\r\n\r\n    if (next) next.classList.add(\"active\");\r\n  }\r\n\r\n  _getConfig(config) {\r\n    config = {\r\n      ...Default,\r\n      ...config,\r\n    };\r\n    Util.typeCheckConfig(NAME, config, DefaultType);\r\n    return config;\r\n  }\r\n\r\n  _handleRelations() {\r\n    this._relations = [];\r\n    for (let name in this._config.filterRelation) {\r\n      let selector = this._config.filterRelation[name];\r\n      this._relations[name] = $(selector).get(0);\r\n      $(this._relations[name]).change((e) => {\r\n        this._element.value = \"\";\r\n        $(this._element).change(); // we need to trigger this manually\r\n        this._items = [];\r\n      });\r\n    }\r\n  }\r\n\r\n  _hideDropdown() {\r\n    this._isShown = false;\r\n    this._dropdown.classList.remove(\"show\");\r\n  }\r\n\r\n  _hideSpinner() {\r\n    this._spinner.style.display = \"none\";\r\n  }\r\n\r\n  _makeDropdown() {\r\n    this._element.parentNode.style.position = \"relative\";\r\n\r\n    let tmpl = '<div class=\"dropdown-menu\" style=\"width:100%\"></div>';\r\n\r\n    this._dropdown = $(tmpl).appendTo(this._element.parentNode).get(0);\r\n  }\r\n\r\n  _makeSpinner() {\r\n    let tmpl =\r\n      '<div class=\"spinner-border spinner-border-sm text-secondary\" role=\"status\"></div>';\r\n\r\n    this._spinner = $(tmpl).appendTo(this._element.parentNode).get(0);\r\n\r\n    $(this._spinner).css({\r\n      position: \"absolute\",\r\n      right: $(this._element).css(\"padding-right\"),\r\n      top:\r\n        this._element.offsetTop +\r\n        (this._element.offsetHeight - this._spinner.offsetHeight) / 2 +\r\n        \"px\",\r\n    });\r\n\r\n    this._hideSpinner();\r\n  }\r\n\r\n  _renderItem(items) {\r\n    items.forEach((i) => {\r\n      if (this._dropdown.children.length >= this._config.maxResult) return;\r\n\r\n      let item = $('<a class=\"dropdown-item\" href=\"#\"></a>');\r\n      let itemEl = item.get(0);\r\n\r\n      item.text(i).appendTo(this._dropdown);\r\n\r\n      if (this._config.onItemRendered)\r\n        this._config.onItemRendered(this._element, itemEl);\r\n\r\n      const renderEvent = $.Event(Event.ITEM_RENDER, { item: itemEl });\r\n\r\n      $(this._element).trigger(renderEvent);\r\n\r\n      item.on(Event.CLICK_DATA_API, (e) => {\r\n        this._selectItem(e.target);\r\n        this._preventClose = true;\r\n        this.hide();\r\n        e.preventDefault();\r\n        this._preventClose = false;\r\n      });\r\n    });\r\n  }\r\n\r\n  _selectItem(item) {\r\n    this._element.value = item.innerText;\r\n\r\n    if (this._config.onPick) this._config.onPick(this._element, item);\r\n\r\n    const pickEvent = $.Event(Event.PICK, { item });\r\n    $(this._element).trigger(pickEvent);\r\n  }\r\n\r\n  _showDropdown() {\r\n    this._isShown = true;\r\n    this._dropdown.classList.add(\"show\");\r\n  }\r\n\r\n  _showSpinner() {\r\n    this._spinner.style.display = \"inline-block\";\r\n  }\r\n\r\n  _truncateDropdown() {\r\n    this._dropdown.innerHTML = \"\";\r\n  }\r\n\r\n  // Static\r\n\r\n  static _jQueryInterface(config, relatedTarget) {\r\n    return this.each(function () {\r\n      let data = $(this).data(DATA_KEY);\r\n      const _config = {\r\n        ...Default,\r\n        ...$(this).data(),\r\n        ...(typeof config === \"object\" && config ? config : {}),\r\n      };\r\n\r\n      if (!data) {\r\n        data = new Autocomplete(this, _config);\r\n        $(this).data(DATA_KEY, data);\r\n      }\r\n\r\n      if (typeof config === \"string\") {\r\n        if (typeof data[config] === \"undefined\")\r\n          throw new TypeError(`No method named \"${config}\"`);\r\n        data[config](relatedTarget);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * ------------------------------------------------------------------------\r\n * jQuery\r\n * ------------------------------------------------------------------------\r\n */\r\n\r\n$.fn[NAME] = Autocomplete._jQueryInterface;\r\n$.fn[NAME].Constructor = Autocomplete;\r\n$.fn[NAME].noConflict = () => {\r\n  $.fn[NAME] = JQUERY_NO_CONFLICT;\r\n  return Autocomplete._jQueryInterface;\r\n};\r\n\r\nexport default Autocomplete;\r\n"],"names":["TRANSITION_END","transitionEndEmulator","duration","_this","this","called","$","one","Util","setTimeout","triggerTransitionEnd","getUID","prefix","Math","random","document","getElementById","getSelectorFromElement","element","selector","getAttribute","hrefAttr","trim","querySelector","err","getTransitionDurationFromElement","transitionDuration","css","transitionDelay","floatTransitionDuration","parseFloat","floatTransitionDelay","split","reflow","offsetHeight","trigger","supportsTransitionEnd","Boolean","isElement","obj","nodeType","typeCheckConfig","componentName","config","configTypes","property","Object","prototype","hasOwnProperty","call","expectedTypes","value","valueType","toString","match","toLowerCase","RegExp","test","Error","toUpperCase","findShadowRoot","documentElement","attachShadow","getRootNode","ShadowRoot","parentNode","root","fn","emulateTransitionEnd","event","special","bindType","delegateType","handle","target","is","handleObj","handler","apply","arguments","NAME","DATA_KEY","EVENT_KEY","DATA_API_KEY","JQUERY_NO_CONFLICT","Default","list","prefetch","filter","filterDelay","filterMinChars","filterRelation","maxResult","onPick","onItemRendered","preProcess","DefaultType","Event","BLUR_DATA_API","CLICK_DATA_API","KEYDOWN_DATA_API","INPUT_DATA_API","PICK","ITEM_RENDER","KeyCode","Autocomplete","_config","_getConfig","_element","_items","_labels","_isShown","_dropdown","_spinner","_result","_query","_preventClose","_timer","_relations","hasAttribute","removeAttribute","TypeError","_handleRelations","setAttribute","_makeDropdown","_makeSpinner","_fetchPresetData","_addElementListener","show","length","_showDropdown","hide","_hideDropdown","dispose","off","removeData","clearTimeout","on","e","_findFromList","item","prevent","keyCode","altKey","_focusNext","_focusPrev","children","get","_selectItem","preventDefault","_truncateDropdown","dataList","_this2","Array","from","forEach","o","val","innerHTML","includes","push","_showSpinner","res","_hideSpinner","i","_findFromAjax","vval","_this3","url","replace","k","sep","el","local","_renderItem","_this4","concat","values","label","next","focused","classList","remove","tmpNext","add","prev","_objectSpread","name","_this5","change","style","display","position","appendTo","right","top","offsetTop","items","_this6","renderEvent","itemEl","text","innerText","pickEvent","_jQueryInterface","relatedTarget","each","data","Constructor","noConflict"],"mappings":"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"}